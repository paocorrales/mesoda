#' Reflectivity color pallete
#'
#' @param colour
#' @param limits
#' @param guide
#' @param ...
#'
#' @export
scale_color_dbz <- function(colours = ref,
                              limits = c(15, 75),

                              guide = guide_colorbar(barheight = 15),
                              ...) {

  # colours <- rgb(ref$R, ref$G, ref$B, maxColorValue = 1)

  scale_color_gradientn(colours = ref,
                        limits = limits,
                        guide = guide, ...)
}

ref <- c(
#   "#646464", # ND
   # "#ccffff", # -30
   # "#cc99cc", # -25
   # "#996699", # -20
   # "#663366", # -15
   # "#cccc99", # -10
   # "#999966", # -5
   # "#646464", # 0
   # "#04e9e7", # 5
   # "#019ff4", # 10
   "#0300f4", # 15
   "#02fd02", # 20
   "#01c501", # 25
   "#008e00", # 30
   "#fdf802", # 35
   "#e5bc00", # 40
   "#fd9500", # 45
   "#fd0000", # 50
   "#d40000", # 55
   "#bc0000", # 60
   "#f800fd", # 65
   "#9854c6", # 70
   "#fdfdfd" # 75
)


ref2 <- dplyr::tribble(
  ~R, ~G, ~B,
   1.0/255.0, 159.0/255.0, 244.0/255.0,
   3.0/255.0,   0.0/255.0, 244.0/255.0,
   2.0/255.0, 253.0/255.0,   2.0/255.0,
   1.0/255.0, 197.0/255.0,   1.0/255.0,
   0.0/255.0, 142.0/255.0,   0.0/255.0,
 253.0/255.0, 248.0/255.0,   2.0/255.0,
 229.0/255.0, 188.0/255.0,   0.0/255.0,
 253.0/255.0, 149.0/255.0,   0.0/255.0,
 253.0/255.0,   0.0/255.0,   0.0/255.0,
# 212.0/255.0,   0.0/255.0,   0.0/255.0,
 188.0/255.0,   0.0/255.0,   0.0/255.0,
 248.0/255.0,   0.0/255.0, 253.0/255.0,
 152.0/255.0,  84.0/255.0, 198.0/255.0
)
